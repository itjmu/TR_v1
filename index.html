<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тасбих-счётчик</title>
    <style>
        /* Все ваши стили остаются без изменений */
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- Меню -->
    <div class="menu-btn" onclick="toggleMenu()">☰</div>
    <div class="sidebar" id="sidebar">
        <div class="menu-header">
            <h3>Меню</h3>
            <span onclick="toggleMenu()">×</span>
        </div>
        <ul class="menu-items">
            <li><a href="#home">Главная</a></li>
            <li><a href="#settings">Настройки</a></li>
            <li><a href="#profile">Профиль</a></li>
            <li><a href="#" onclick="showStats()">Статистика</a></li> <!-- Новый пункт меню -->
        </ul>
    </div>
    <div class="overlay" id="overlay" onclick="toggleMenu()"></div>

    <!-- Остальной HTML остаётся без изменений -->

    <script>
        // Настройки
        const SETTINGS = {
            zikrList: [
                "СубhаналЛоh",
                "АлhамдулилЛah",
                "Аллоhу Акбар",
                "Ла илАhа иллалЛоh", 
                "АстагфирулЛoh", 
                "СубhаналЛоhи ва баhамдиhиhи", 
                "Ла илаha илла-лЛоhу ваhдаhу ла шарика лаh. Лаhул мулку ва лаhу-л haмда ва hува ъала кулли шайин Qадир" 
            ],
            levels: [
                {required: 3500, level: 1},
                {required: 7000, level: 2},
                {required: 14000, level: 3},
                {required: 30000, level: 4},
                {required: 50000, level: 5}
            ]
        };

        // Данные приложения
        let appData = JSON.parse(localStorage.getItem('tasbihData')) || {
            count: 0,
            totalCount: 0,
            currentZikrIndex: 0,
            firstVisitDate: new Date().toLocaleString(), // Дата первого захода
            dailyCount: 0, // Ежедневные счётчики
            lastVisitDate: new Date().toLocaleDateString() // Дата последнего захода
        };

        const tg = window.Telegram.WebApp;

        // Инициализация WebApp
        tg.ready();
        tg.expand();

        // Функция сохранения данных
        function saveData() {
            localStorage.setItem('tasbihData', JSON.stringify(appData));
            if(tg?.sendData) {
                tg.sendData(JSON.stringify(appData));
            }
        }

        // Функция обновления интерфейса
        function updateDisplays() {
            document.getElementById('count').textContent = appData.count;
            document.getElementById('total-count').textContent = appData.totalCount;
            document.getElementById('zikr-text').textContent = 
                SETTINGS.zikrList[appData.currentZikrIndex];
            
            document.querySelector('.main-progress').style.width = 
                `${(appData.count/33)*100}%`;
            document.querySelector('.level-progress').style.width = 
                `${calculateLevelProgress()}%`;
        }

        // Функция для расчёта прогресса уровня
        function calculateLevelProgress() {
            const currentLevel = SETTINGS.levels.find(l => appData.totalCount < l.required) || {level: 5};
            document.getElementById('level').textContent = currentLevel.level;
            const prevLevel = SETTINGS.levels[currentLevel.level-2] || {required: 0};
            return ((appData.totalCount - prevLevel.required)/(currentLevel.required - prevLevel.required))*100 || 100;
        }

        // Функция для отображения статистики
        function showStats() {
            const today = new Date().toLocaleDateString();
            if (appData.lastVisitDate !== today) {
                appData.dailyCount = 0; // Сбрасываем ежедневные счётчики
                appData.lastVisitDate = today;
            }

            alert(`
                Статистика:
                - Уровень: ${document.getElementById('level').textContent}
                - Ежедневные счётчики: ${appData.dailyCount}
                - Общий счёт: ${appData.totalCount}
                - Дата первого захода: ${appData.firstVisitDate}
            `);
        }

        // Обработчик кликов
        document.addEventListener('click', (e) => {
            if(!e.target.closest('#reset') && !e.target.closest('.menu-btn')) {
                if(document.getElementById('sidebar').classList.contains('active')) {
                    toggleMenu();
                }
                
                appData.count++;
                appData.totalCount++;
                appData.dailyCount++;
                
                if(appData.count === 33) {
                    appData.count = 0;
                    appData.currentZikrIndex = (appData.currentZikrIndex + 1) % SETTINGS.zikrList.length;
                }
                
                updateDisplays();
                saveData();
            }
        });

        // Обработчик сброса
        document.getElementById('reset').addEventListener('click', () => {
            appData.count = 0;
            appData.currentZikrIndex = 0;
            updateDisplays();
            saveData();
        });

        // Инициализация
        updateDisplays();
    </script>
</body>
</html>